= form_for(@place) do |f|
  .row
    .col-xs-12
      - if @place.unreviewed_version
        .red currently under review
    .col-md-6
      %fieldset{class: "form-group row #{'has-error' if f.object.errors.include?(:name)}"}
        .col-xs-12
          = f.text_field :name, placeholder: Place.human_attribute_name('name'), class: 'form-control', disabled: @place.unreviewed_version

      %fieldset{class: "form-group row #{'has-error' if f.object.errors.include?(:street)}"}
        .col-xs-8
          = f.text_field :street, placeholder: Place.human_attribute_name('street'), class: 'form-control', value: @geocoded ? @geocoded['road'] : @place.street, disabled: @place.unreviewed_version
        .col-xs-4
          = f.text_field :house_number, placeholder: 'Nr.', class: 'form-control', value: @geocoded ? @geocoded['house_number'] : @place.house_number, disabled: @place.unreviewed_version

      %fieldset{class: "form-group row #{'has-error' if f.object.errors.include?(:postal_code) || f.object.errors.include?(:city)}"}
        .col-xs-5
          = f.text_field :postal_code, placeholder: Place.human_attribute_name('postal_code'), class: 'form-control', value: @geocoded ? @geocoded['postcode'] : @place.postal_code, disabled: @place.unreviewed_version
        .col-xs-7
          = f.text_field :city, placeholder: Place.human_attribute_name('city'), class: 'form-control', value: @geocoded ? @geocoded['village'] || @geocoded['town'] || @geocoded['state'] : @place.city, disabled: @place.unreviewed_version

      %fieldset{class: "form-group row #{'has-error' if f.object.errors.include?(:phone) || f.object.errors.include?(:email) || f.object.errors.include?(:homepage)}"}
        .col-sm-4
          = f.text_field :phone, placeholder: Place.human_attribute_name('phone'), class: 'form-control', disabled: @place.unreviewed_version
        .col-sm-4
          = f.text_field :email, placeholder: Place.human_attribute_name('email'), class: 'form-control', disabled: @place.unreviewed_version
        .col-sm-4
          = f.text_field :homepage, placeholder: Place.human_attribute_name('Homepage'), class: 'form-control', disabled: @place.unreviewed_version
  .row
    %hr

  .row
    - I18n.available_locales.in_groups_of(2, false).each do |group|
      - group.each do |lang|
        - locale != lang ? hidden = 'hidden-description' : hidden = ''
        - column = "description_#{lang}"
        - translation = @place.translations.find_by(locale: lang)
        .col-xs-12
          .description-header
            %h4= t(column)
            - if locale != lang
              %h4.description-header.glyphicon.glyphicon-triangle-bottom
            - else
              %h4.description-header.glyphicon.glyphicon-triangle-top
          .description-editor{dir: "#{'rtl' if lang == 'ar'}", class: hidden}
            - if translation && translation.versions.length > 1
              %br
              .red= t('currently_under_review')
              = f.text_area column.to_sym, class: "description-area locked-description", disabled: true
            - elsif translation && translation.auto_translated
              %i (#{t('.auto_translated')})
              = f.text_area column.to_sym, class: "wysihtml5 description-area", id: "#{column}"
            - else
              = f.text_area column.to_sym, class: "wysihtml5 description-area", id: "#{column}"
  .row
    %hr

  .row
    .col-xs-12
      %h4= t('.categories')
      - Category.all.each do |category|
        .col-xs-8.col-sm-4{dir: "#{text_direction}"}
          = category.name
        .col-xs-4.col-sm-2
          = check_box_tag 'place[categories][]', category.id, f.object.category_for(category.id), disabled: @place.unreviewed_version

  .row
    %hr

  .row
    .col-md-6
      = show_simple_captcha unless signed_in?
  .row
    .submit-process-bar.text-center
      = render 'layouts/loading'
    .col-xs-6
      = f.hidden_field :latitude, value: params[:latitude]
      = f.hidden_field :longitude, value: params[:longitude]
      = f.submit class: 'btn btn-primary btn-success place-form-button submit-place-button'
    .col-xs-6.col-md-2
      = link_to t('buttons.back'), '', class: 'btn btn-primary btn-danger place-form-button back-button'
